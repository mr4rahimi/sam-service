---
/**
 * LedFrame.astro
 * Bright moving blue LED around a frame (CSS-only, reusable)
 *
 * Props:
 *  - class: extra classes
 *  - radius: border radius (e.g. "32px")
 *  - padding: inner padding (e.g. "10px")
 *  - speed: animation duration seconds (e.g. 6)
 *  - thickness: LED border thickness (e.g. "3px")
 *  - glow: outer glow strength (0..1)
 *  - beam: how strong the moving bright "head" is (0..1.2)
 *  - base: base ring brightness (0..1)
 *  - hue: LED hue rotate in degrees (0 = pure blue/cyan-ish)
 */
const {
  class: className = "",
  radius = "32px",
  padding = "10px",
  speed = 2.8,
  thickness = "3px",
  glow = 0.75,
  beam = 1.0,
  base = 0.55,
  hue = 0,
} = Astro.props;
---

<div
  class={`led-frame ${className}`}
  style={`
    --led-radius: ${radius};
    --led-pad: ${padding};
    --led-speed: ${speed}s;
    --led-thickness: ${thickness};
    --led-glow: ${glow};
    --led-beam: ${beam};
    --led-base: ${base};
    --led-hue: ${hue}deg;
  `}
>
  <div class="led-inner">
    <slot />
  </div>
</div>

<style>
  .led-frame {
    position: relative;
    border-radius: var(--led-radius);
    padding: var(--led-pad);
    overflow: hidden;

    /* background shell */
    border: 1px solid rgba(255,255,255,0.10);
    background:
      radial-gradient(900px 420px at 15% 0%, rgba(255,255,255,0.08), transparent 60%),
      linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  }

  .led-inner {
    position: relative;
    border-radius: calc(var(--led-radius) - 10px);
    overflow: hidden;
    background: rgba(10,14,22,0.18);
    box-shadow:
      0 28px 70px rgba(0,0,0,0.55),
      inset 0 1px 0 rgba(255,255,255,0.18);
    z-index: 1;
  }

  /* =========================
     LED RING (Layer 1: sharp ring)
     ========================= */
  .led-frame::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: var(--led-radius);
    padding: var(--led-thickness);
    pointer-events: none;

    /* Base ring + moving bright beam (conic gradients stacked) */
    background:
      /* Moving bright "head" (beam) */
      conic-gradient(
        from var(--a),
        rgba(0, 200, 255, 0.00) 0deg,
        rgba(0, 200, 255, 0.00) 285deg,
        rgba(0, 220, 255, calc(0.55 * var(--led-beam))) 305deg,
        rgba(0, 240, 255, calc(1.00 * var(--led-beam))) 325deg,
        rgba(0, 220, 255, calc(0.55 * var(--led-beam))) 345deg,
        rgba(0, 200, 255, 0.00) 360deg
      ),
      /* Base ring glow (all around) */
      conic-gradient(
        from 0deg,
        rgba(0, 190, 255, calc(0.10 * var(--led-base))),
        rgba(0, 210, 255, calc(0.16 * var(--led-base))),
        rgba(0, 190, 255, calc(0.10 * var(--led-base)))
      );

    filter:
      hue-rotate(var(--led-hue))
      saturate(1.35);

    /* Cut-out center => only border remains */
    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
            mask-composite: exclude;

    /* Make it crisp + bright */
    opacity: 1;
    mix-blend-mode: screen;

    /* Animate only a CSS var (cheap) */
    animation: led-rotate var(--led-speed) linear infinite;
  }

  /* =========================
     LED GLOW (Layer 2: bloom outside)
     ========================= */
  .led-frame::after {
    content: "";
    position: absolute;
    inset: -30%;
    pointer-events: none;

    background:
      radial-gradient(circle at 50% 50%,
        rgba(0, 210, 255, calc(0.20 * var(--led-glow))),
        transparent 55%
      ),
      conic-gradient(
        from var(--a),
        rgba(0, 210, 255, 0.00) 0deg,
        rgba(0, 210, 255, 0.00) 300deg,
        rgba(0, 220, 255, calc(0.40 * var(--led-glow))) 320deg,
        rgba(0, 240, 255, calc(0.70 * var(--led-glow))) 336deg,
        rgba(0, 220, 255, calc(0.40 * var(--led-glow))) 352deg,
        rgba(0, 210, 255, 0.00) 360deg
      );

    filter:
      hue-rotate(var(--led-hue))
      blur(18px)
      saturate(1.35);

    opacity: 1;
    mix-blend-mode: screen;
    animation: led-rotate var(--led-speed) linear infinite;
  }

  /* Animate a custom property so gradients rotate smoothly */
  @property --a {
    syntax: "<angle>";
    inherits: false;
    initial-value: 0deg;
  }

  @keyframes led-rotate {
    to { --a: 360deg; }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .led-frame::before,
    .led-frame::after {
      animation: none;
    }
  }
</style>
